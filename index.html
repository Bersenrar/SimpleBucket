<!DOCTYPE html>

<html>
    <head>
        <link rel="stylesheet" href="./styles.css">
    </head>

    <body>
        <div class="welcome_cont">
            <div class="welcome_title">
                <h1>
                    Book-Shop
                </h1>
                <hr>
            </div>
            
            <div class="bucket_section">
                <a href="./bucket.html">
                    <b><span id="bucket_counter">0</span></b>
                    <img src="./shopping-cart-outline-svgrepo-com.svg">
                </a>
            </div>
            
        </div>

        <div class="books">
            <div class="product" id="chtulhu">
                <div class="photo">
                    <img src="./zov-ktulhu-govard.webp">
                </div>

                <article class="description">
                    Американський письменник, поет і журналіст Говард Філіпс Лавкрафт (1890—1937) працював у жанрі хорору, містики,<br>
                     фентезі та наукової фантастики й був творцем і магістром американської містичної «чорної школи» 20—30-х років минулого століття.<br>
                    За життя він не опублікував жодної книжки і зажив слави серед широкого читацького загалу вже після своєї смерті.<br>
                </article>
                <div id="bb_cont" data-book-name="chtulhu">
                    <label for="buy_button"><b>500 грн</b></label>
                    <input type="button" value="Придбати" class="buy_button" id="chtulhu_input">
                </div>
            </div>

            <div class="product" id="fiesta">
                <div class="photo">
                    <img src="./4140247409_fiesta-ernest-heminguej.webp">
                </div>

                <article class="description">
                    Американський журналіст Джейк Барнс відвоював на фронтах Першої світової, де отримав важкі поранення. <br>
                    Барнс щоночі проводить час з друзями в барі на бульварі Монпарнас, сподіваючись, що алкоголь допоможе йому залікувати душевні і тілесні рани, завдані Першою світовою війною. <br>
                    Барнс закоханий у Брет Ешлі, яка втілює собою нову сексуальну свободу 1920-х років, має численні романи. Вона теж закохана в Барнса, однак, через отримані на війні Джейком травм, їх роман має платонічний характер.<br>
                </article>
                <div id="bb_cont" data-book-name="fiesta">
                    <label for="buy_button"><b>599 грн</b></label>
                    <input type="button" value="Придбати" class="buy_button" id="chtulhu_input">
                </div>
            </div>

        </div>

        <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
        <script>
            
            localStorage.setItem(
                "data_json", '{"whole_amt":0, "whole_summ":0, "books":{"chtulhu":{"amt":0, "price":500}, "fiesta": {"amt": 0, "price":599}}}'
                );
            $(document).ready(function(){
            $(".buy_button").on("click", function(e){
                    
                    let data = JSON.parse(localStorage.getItem("data_json"));

                    let whole_amt = ++data["whole_amt"];

                    let parent_div = $(this).parent();
                    let book_name = parent_div.data()["bookName"];
                    
                    data["whole_amt"] = whole_amt;
                    data["books"][book_name]["amt"] = ++data["books"][book_name]["amt"];
                    data["whole_summ"] = data["whole_summ"] + data["books"][book_name]["price"];

                    localStorage.setItem(
                        "data_json",
                        JSON.stringify(data)
                    );

                    $("#bucket_counter").text(whole_amt);

                    console.log(localStorage.getItem("data_json"));
                });
            });
        </script>
    </body>
</html>